{
  "openapi": "3.0.1",
  "info": {
    "title": "Events MS",
    "description": "Events MS",
    "version": "1.0"
  },
  "servers": [
    {
      "url": "http://localhost:9001",
      "description": "Servidor local en puerto 9001"
    }
  ],
  "tags": [
    {
      "name": "Events",
      "description": "API para registrar eventos en el sistema"
    },
    {
      "name": "Errors",
      "description": "API para registrar errores en el sistema"
    }
  ],
  "paths": {
    "/events-ms/events": {
      "post": {
        "tags": ["Events"],
        "summary": "Registrar un evento",
        "description": "Crea un nuevo evento en el sistema y lo almacena en la base de datos.",
        "operationId": "logEvent",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/EventRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "Evento registrado correctamente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "example": {
                    "message": "Created resource"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "*/*": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "object"
                  }
                }
              }
            }
          },
          "400": {
            "description": "Petición inválida",
            "content": {
              "*/*": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "object"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/events-ms/errors": {
      "post": {
        "tags": ["Errors"],
        "summary": "Registrar un error",
        "description": "Crea un nuevo registro de error en el sistema y lo almacena en la base de datos.",
        "operationId": "logError",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ErrorRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "500": {
            "description": "Error interno del servidor",
            "content": {
              "*/*": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "object"
                  }
                }
              }
            }
          },
          "400": {
            "description": "Petición inválida",
            "content": {
              "*/*": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "object"
                  }
                }
              }
            }
          },
          "201": {
            "description": "Error registrado correctamente",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "example": {
                    "message": "Created resource"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/events-ms/public/app/version": {
      "get": {
        "tags": ["application-controller"],
        "operationId": "getVersion",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "*/*": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "object"
                  }
                }
              }
            }
          }
        }
      }
    },
    "/events-ms/public/app/healthCheck": {
      "get": {
        "tags": ["application-controller"],
        "operationId": "healthCheck",
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "*/*": {
                "schema": {
                  "type": "object",
                  "additionalProperties": {
                    "type": "object"
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "schemas": {
      "EventRequest": {
        "type": "object",
        "properties": {
          "application": {
            "type": "string",
            "description": "Nombre de la aplicación que genera el evento",
            "example": "mobile-app"
          },
          "applicationVersion": {
            "type": "string",
            "description": "Versión de la aplicación",
            "example": "1.0.3"
          },
          "userId": {
            "type": "string",
            "description": "Identificador único del usuario asociado al evento",
            "example": "user-123"
          },
          "sessionId": {
            "type": "string",
            "description": "Identificador de la sesión en curso",
            "example": "session-abc-456"
          },
          "action": {
            "type": "string",
            "description": "Acción realizada por el usuario o sistema",
            "example": "LOGIN"
          },
          "description": {
            "type": "string",
            "description": "Descripción adicional del evento",
            "example": "Usuario inició sesión desde dispositivo Android"
          },
          "deviceInfo": {
            "type": "object",
            "additionalProperties": {
              "type": "object",
              "description": "Información del dispositivo desde el que se ejecutó la acción",
              "example": {
                "os": "Android",
                "version": "14",
                "model": "Samsung S23"
              }
            },
            "description": "Información del dispositivo desde el que se ejecutó la acción",
            "example": {
              "os": "Android",
              "version": "14",
              "model": "Samsung S23"
            }
          },
          "metadata": {
            "type": "object",
            "additionalProperties": {
              "type": "object",
              "description": "Metadatos adicionales relacionados con el evento",
              "example": {
                "location": "Buenos Aires",
                "network": "WiFi"
              }
            },
            "description": "Metadatos adicionales relacionados con el evento",
            "example": {
              "location": "Buenos Aires",
              "network": "WiFi"
            }
          },
          "httpLog": {
            "$ref": "#/components/schemas/HttpLog"
          }
        },
        "description": "Objeto que representa un evento a registrar en el sistema"
      },
      "HttpLog": {
        "type": "object",
        "properties": {
          "url": {
            "type": "string",
            "description": "URL de la petición realizada",
            "example": "https://api.misitio.com/orders"
          },
          "queryParams": {
            "type": "string",
            "description": "Parámetros de la query enviados en la petición",
            "example": "userId=123&status=active"
          },
          "requestBody": {
            "type": "string",
            "description": "Cuerpo de la petición enviada",
            "example": "{\"productId\":\"A001\",\"quantity\":2}"
          },
          "responseBody": {
            "type": "string",
            "description": "Cuerpo de la respuesta recibida",
            "example": "{\"orderId\":\"ORD-98765\",\"status\":\"CREATED\"}"
          },
          "statusCode": {
            "type": "integer",
            "description": "Código de estado HTTP recibido",
            "format": "int32",
            "example": 201
          }
        },
        "description": "Detalle de la comunicación HTTP asociada a un evento o error"
      },
      "ErrorRequest": {
        "type": "object",
        "properties": {
          "application": {
            "type": "string",
            "description": "Nombre de la aplicación que generó el error",
            "example": "mobile-app"
          },
          "applicationVersion": {
            "type": "string",
            "description": "Versión de la aplicación",
            "example": "1.0.3"
          },
          "userId": {
            "type": "string",
            "description": "Identificador único del usuario afectado por el error",
            "example": "user-123"
          },
          "sessionId": {
            "type": "string",
            "description": "Identificador de la sesión en curso",
            "example": "session-xyz-789"
          },
          "action": {
            "type": "string",
            "description": "Acción que estaba ejecutando el usuario al generarse el error",
            "example": "CREATE_ORDER"
          },
          "errorMessage": {
            "type": "string",
            "description": "Mensaje de error generado por la aplicación o servicio",
            "example": "NullPointerException en OrderService"
          },
          "statusCode": {
            "type": "integer",
            "description": "Código de estado asociado al error (HTTP o interno)",
            "format": "int32",
            "example": 500
          },
          "deviceInfo": {
            "type": "object",
            "additionalProperties": {
              "type": "object",
              "description": "Información del dispositivo donde ocurrió el error",
              "example": {
                "os": "iOS",
                "version": "17.2",
                "model": "iPhone 14"
              }
            },
            "description": "Información del dispositivo donde ocurrió el error",
            "example": {
              "os": "iOS",
              "version": "17.2",
              "model": "iPhone 14"
            }
          },
          "metadata": {
            "type": "object",
            "additionalProperties": {
              "type": "object",
              "description": "Metadatos adicionales relacionados con el error",
              "example": {
                "location": "Córdoba",
                "network": "4G"
              }
            },
            "description": "Metadatos adicionales relacionados con el error",
            "example": {
              "location": "Córdoba",
              "network": "4G"
            }
          },
          "httpLog": {
            "$ref": "#/components/schemas/HttpLog"
          }
        },
        "description": "Objeto que representa un error a registrar en el sistema"
      }
    }
  }
}
